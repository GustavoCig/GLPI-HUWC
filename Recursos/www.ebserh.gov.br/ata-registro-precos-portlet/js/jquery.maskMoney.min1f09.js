!function(c){c.browser||(c.browser={},c.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),c.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),c.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),c.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var b={destroy:function(){return c(this).unbind(".maskMoney"),c.browser.msie&&(this.onpaste=null),this},mask:function(d){return this.each(function(){var a,e=c(this);return"number"==typeof d&&(e.trigger("mask"),a=c(e.val().split(/\D/)).last()[0].length,d=d.toFixed(a),e.val(d)),e.trigger("mask")})},unmasked:function(){return this.map(function(){var e,d=c(this).val()||"0",f=-1!==d.indexOf("-");return c(d.split(/\D/).reverse()).each(function(a,g){return g?(e=g,!1):void 0}),d=d.replace(/\D/g,""),d=d.replace(new RegExp(e+"$"),"."+e),f&&(d="-"+d),parseFloat(d)})},init:function(d){return d=c.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1},d),this.each(function(){function J(){var j,i,p,o,n,m=a.get(0),l=0,k=0;return"number"==typeof m.selectionStart&&"number"==typeof m.selectionEnd?(l=m.selectionStart,k=m.selectionEnd):(i=document.selection.createRange(),i&&i.parentElement()===m&&(o=m.value.length,j=m.value.replace(/\r\n/g,"\n"),p=m.createTextRange(),p.moveToBookmark(i.getBookmark()),n=m.createTextRange(),n.collapse(!1),p.compareEndPoints("StartToEnd",n)>-1?l=k=o:(l=-p.moveStart("character",-o),l+=j.slice(0,l).split("\n").length-1,p.compareEndPoints("EndToEnd",n)>-1?k=o:(k=-p.moveEnd("character",-o),k+=j.slice(0,k).split("\n").length-1)))),{start:l,end:k}}function I(){var h=!(a.val().length>=a.attr("maxlength")&&a.attr("maxlength")>=0),m=J(),l=m.start,k=m.end,j=m.start!==m.end&&a.val().substring(l,k).match(/\d/)?!0:!1,i="0"===a.val().substring(0,1);return h||j||i}function H(e){a.each(function(f,h){if(h.setSelectionRange){h.focus(),h.setSelectionRange(e,e)}else{if(h.createTextRange){var g=h.createTextRange();g.collapse(!0),g.moveEnd("character",e),g.moveStart("character",e),g.select()}}})}function G(e){var f="";return e.indexOf("-")>-1&&(e=e.replace("-",""),f="-"),f+d.prefix+e+d.suffix}function F(e){var o,n,m,l=e.indexOf("-")>-1&&d.allowNegative?"-":"",k=e.replace(/[^0-9]/g,""),j=k.slice(0,k.length-d.precision);return j=j.replace(/^0*/g,""),j=j.replace(/\B(?=(\d{3})+(?!\d))/g,d.thousands),""===j&&(j="0"),o=l+j,d.precision>0&&(n=k.slice(k.length-d.precision),m=new Array(d.precision+1-n.length).join(0),o+=d.decimal+m+n),G(o)}function E(f){var e,g=a.val().length;a.val(F(a.val())),e=a.val().length,f-=g-e,H(f)}function D(){var e=a.val();a.val(F(e))}function C(){var e=a.val();return d.allowNegative?""!==e&&"-"===e.charAt(0)?e.replace("-",""):"-"+e:e}function B(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function A(i){i=i||window.event;var p,o,n,m,j,g=i.which||i.charCode||i.keyCode;return void 0===g?!1:48>g||g>57?45===g?(a.val(C()),!1):43===g?(a.val(a.val().replace("-","")),!1):13===g||9===g?!0:!c.browser.mozilla||37!==g&&39!==g||0!==i.charCode?(B(i),!0):!0:I()?(B(i),p=String.fromCharCode(g),o=J(),n=o.start,m=o.end,j=a.val(),a.val(j.substring(0,n)+p+j.substring(m,j.length)),E(n+1),!1):!1}function z(p){p=p||window.event;var o,n,m,l,j,g=p.which||p.charCode||p.keyCode;return void 0===g?!1:(o=J(),n=o.start,m=o.end,8===g||46===g||63272===g?(B(p),l=a.val(),n===m&&(8===g?""===d.suffix?n-=1:(j=l.split("").reverse().join("").search(/\d/),n=l.length-j-1,m=n+1):m+=1),a.val(l.substring(0,n)+l.substring(m,l.length)),E(n),!1):9===g?!0:!0)}function y(){t=a.val(),D();var f,e=a.get(0);e.createTextRange&&(f=e.createTextRange(),f.collapse(!1),f.select())}function x(){setTimeout(function(){D()},0)}function w(){var e=parseFloat("0")/Math.pow(10,d.precision);return e.toFixed(d.precision).replace(new RegExp("\\.","g"),d.decimal)}function v(e){if(c.browser.msie&&A(e),""===a.val()||a.val()===G(w())){d.allowZero?d.affixesStay?a.val(G(w())):a.val(w()):a.val("")}else{if(!d.affixesStay){var f=a.val().replace(d.prefix,"").replace(d.suffix,"");a.val(f)}}a.val()!==t&&a.change()}function u(){var f,e=a.get(0);e.setSelectionRange?(f=a.val().length,e.setSelectionRange(f,f)):a.val(a.val())}var t,a=c(this);d=c.extend(d,a.data()),a.unbind(".maskMoney"),a.bind("keypress.maskMoney",A),a.bind("keydown.maskMoney",z),a.bind("blur.maskMoney",v),a.bind("focus.maskMoney",y),a.bind("click.maskMoney",u),a.bind("cut.maskMoney",x),a.bind("paste.maskMoney",x),a.bind("mask.maskMoney",D)})}};c.fn.maskMoney=function(a){return b[a]?b[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?(c.error("Method "+a+" does not exist on jQuery.maskMoney"),void 0):b.init.apply(this,arguments)}}(window.jQuery||window.Zepto);