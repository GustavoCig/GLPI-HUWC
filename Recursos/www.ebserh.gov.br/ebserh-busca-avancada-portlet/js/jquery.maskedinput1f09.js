function getPasteEvent(){var b=document.createElement("input"),a="onpaste";b.setAttribute(a,"");return(typeof b[a]==="function")?"paste":"input"}var pasteEventName=getPasteEvent()+".mask",ua=navigator.userAgent,iPhone=/iphone/i.test(ua),android=/android/i.test(ua),caretTimeoutId;$.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_",};$.fn.extend({caret:function(c,a){var b;if(this.length===0||this.is(":hidden")){return}if(typeof c=="number"){a=(typeof a==="number")?a:c;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(c,a)}else{if(this.createTextRange){b=this.createTextRange();b.collapse(true);b.moveEnd("character",a);b.moveStart("character",c);b.select()}}})}else{if(this[0].setSelectionRange){c=this[0].selectionStart;a=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){b=document.selection.createRange();c=0-b.duplicate().moveStart("character",-100000);a=c+b.text.length}}return{begin:c,end:a}}},unmask:function(){return this.trigger("unmask")},mask:function(c,g){var d,b,f,h,e,a;if(!c&&this.length>0){d=$(this[0]);return d.data($.mask.dataName)()}g=$.extend({placeholder:$.mask.placeholder,completed:null},g);b=$.mask.definitions;f=[];h=a=c.length;e=null;$.each(c.split(""),function(j,k){if(k=="?"){a--;h=j}else{if(b[k]){f.push(new RegExp(b[k]));if(e===null){e=f.length-1}}else{f.push(null)}}});return this.trigger("unmask").each(function(){var r=$(this),m=$.map(c.split(""),function(v,u){if(v!="?"){return b[v]?g.placeholder:v}}),t=r.val();function q(u){while(++u<a&&!f[u]){}return u}function n(u){while(--u>=0&&!f[u]){}return u}function l(x,u){var w,v;if(x<0){return}for(w=x,v=q(u);w<a;w++){if(f[w]){if(v<a&&f[w].test(m[v])){m[w]=m[v];m[v]=g.placeholder}else{break}v=q(v)}}p();r.caret(Math.max(e,x))}function i(y){var w,x,u,v;for(w=y,x=g.placeholder;w<a;w++){if(f[w]){u=q(w);v=m[w];m[w]=x;if(u<a&&f[u].test(v)){x=v}else{break}}}}function o(x){var v=x.which,y,w,u;if(v===8||v===46||(iPhone&&v===127)){y=r.caret();w=y.begin;u=y.end;if(u-w===0){w=v!==46?n(w):(u=q(w-1));u=v===46?q(u):u}j(w,u);l(w,u-1);x.preventDefault()}else{if(v==27){r.val(t);r.caret(0,k());x.preventDefault()}}}function s(x){var u=x.which,z=r.caret(),w,y,v;if(x.ctrlKey||x.altKey||x.metaKey||u<32){return}else{if(u){if(z.end-z.begin!==0){j(z.begin,z.end);l(z.begin,z.end-1)}w=q(z.begin-1);if(w<a){y=String.fromCharCode(u);if(f[w].test(y)){i(w);m[w]=y;p();v=q(w);if(android){setTimeout($.proxy($.fn.caret,r,v),0)}else{r.caret(v)}if(g.completed&&v>=a){g.completed.call(r)}}}x.preventDefault()}}}function j(w,u){var v;for(v=w;v<u&&v<a;v++){if(f[v]){m[v]=g.placeholder}}}function p(){r.val(m.join(""))}function k(v){var y=r.val(),x=-1,u,w;for(u=0,pos=0;u<a;u++){if(f[u]){m[u]=g.placeholder;while(pos++<y.length){w=y.charAt(pos-1);if(f[u].test(w)){m[u]=w;x=u;break}}if(pos>y.length){break}}else{if(m[u]===y.charAt(pos)&&u!==h){pos++;x=u}}}if(v){p()}else{if(x+1<h){r.val("");j(0,a)}else{p();r.val(r.val().substring(0,x+1))}}return(h?u:e)}r.data($.mask.dataName,function(){return $.map(m,function(v,u){return f[u]&&v!=g.placeholder?v:null}).join("")});if(!r.attr("readonly")){r.one("unmask",function(){r.unbind(".mask").removeData($.mask.dataName)}).bind("focus.mask",function(){clearTimeout(caretTimeoutId);var v,u;t=r.val();v=k();caretTimeoutId=setTimeout(function(){p();if(v==c.length){r.caret(0,v)}else{r.caret(v)}},10)}).bind("blur.mask",function(){k();if(r.val()!=t){r.change()}}).bind("keydown.mask",o).bind("keypress.mask",s).bind(pasteEventName,function(){setTimeout(function(){var u=k(true);r.caret(u);if(g.completed&&u==r.val().length){g.completed.call(r)}},0)})}k()})}});